- Combine Two Tables
  Write a SQL query for a report that provides the following information for each person in the Person table, regardless if there is an address for each of those people:
  FirstName, LastName, City, State
  
  SELECT P.FirstName,
         P.LastName,
         A.City,
         A.State
    FROM Person P
    LEFT JOIN Address A
    ON P.PersonID = A.PersonID;
    
    
- Employee Bonus
  Select all employee's name and bonus whose bonus is < 1000
  
  SELECT E.name,
         B.bonus
    FROM Employee E
    LEFT JOIN Bonus B
    ON E.empID = B.empID
    WHERE B.bonus is null or B.bonus < 1000;
    
    
- Second Highest Salary
  Write a SQL query to get the second highest salary from the Employee table.
  
  SELECT MAX(Salary) AS SecondHighestSalary
    FROM Employee
    WHERE Salary < (
                        SELECT MAX(Salary)
                            FROM Employee
                    );
                    
                    ((OR))
                    
 SELECT 
    IFNULL(
            (SELECT DISTINCT Salary
                FROM Employee
                ORDER BY Salary Desc
                LIMIT 1 OFFSET 1),
                NULL
            ) AS SecondHighestSalary
            
            
- Nth Highest Salary
  Write a SQL query to get the nth highest salary from the Employee table.
  
  CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
    BEGIN
    RETURN (
              SELECT DISTINCT SALARY
                  FROM
                      (
                        SELECT Salary,
                                DENSE_RANK() OVER (ORDER BY SALARY DESC) AS RK
                            FROM Employee
                        )T
             WHERE RK = N
          );
  END


            ((OR))
            
  CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
  BEGIN
  SET N=N-1;
  RETURN (
            SELECT IFNULL
            (
                (
                    SELECT DISTINCT Salary 
                      FROM Employee 
                      ORDER BY Salary DESC LIMIT 1 OFFSET N
                ), NULL
              )              
       );
  END
  
- Recyclable and Low Fat Products
  Write an SQL query to find the ids of products that are both low fat and recyclable.
  
  SELECT product_id
    FROM Products
    WHERE low_fats = 'Y'
    AND recyclable = 'Y';

- Find Total Time Spent by Each Employee
  Write an SQL query to calculate the total time in minutes spent by each employee on each day at the office. 
  Note that within one day, an employee can enter and leave more than once. 
  The time spent in the office for a single entry is out_time - in_time.
  
  SELECT event_day AS day,
       emp_id,
       SUM(out_time - in_time) AS total_time
    FROM Employees
    GROUP BY day, emp_id;
    
- Daily Leads and Partners

  SELECT date_id, 
       make_name,
       count(DISTINCT lead_id) AS unique_leads,
       count(DISTINCT partner_id) AS unique_partners
    FROM DailySales
    GROUP BY date_id, make_name;
    
- Invalid Tweets
  SELECT tweet_id 
    FROM Tweets
    WHERE LENGTH(content) > 15;
    
- Students With Invalid Departments
  Write an SQL query to find the id and the name of all students who are enrolled in departments that no longer exists.
  
  SELECT ID,Name
    FROM Students
    WHERE department_id NOT IN
    (
        SELECT DISTINCT ID
            FROM Departments
    );
    
    ((OR))
    
  SELECT S.ID,
       S.Name
    FROM Students S
    LEFT JOIN Departments D
    on S.Department_ID = D.ID
    where D.ID IS NULL;
    
- Replace Employee ID With The Unique Identifier
  Write an SQL query to show the unique ID of each user, If a user doesn't have a unique ID replace just show null.
  
  SELECT EUNI.unique_id, E.name
    FROM EmployeeUNI as EUNI
    RIGHT JOIN Employees E
    ON E.id = EUNI.id;

- Bank Account Summary II
  Write an SQL query to report the name and balance of users with a balance higher than 10000. 
  The balance of an account is equal to the sum of the amounts of all transactions involving that account.
  
  SELECT U.Name, SUM(T.Amount) AS balance
    FROM Transactions T
    INNER JOIN Users U
    ON T.Account = U.Account
    GROUP BY U.Name
    HAVING balance > 10000;
- Warehouse Manager
  Write an SQL query to report, How much cubic feet of volume does the inventory occupy in each warehouse.

    warehouse_name
    volume
    
  SELECT W.Name AS WAREHOUSE_NAME,
       SUM(W.Units*P.Width*P.Length*P.Height) as VOLUME
       FROM Warehouse W
       INNER JOIN Products P
       ON W.Product_ID = P.Product_ID
       Group BY W.Name;
       
- Customer Who Visited but Did Not Make Any Transactions
  Write an SQL query to find the IDs of the users who visited without making any transactions and the number of times they made these types of visits.
  
  SELECT V.customer_id, COUNT(V.VISIT_ID) AS count_no_trans
    FROM Visits V
    LEFT JOIN Transactions T
    ON V.Visit_ID = T.Visit_ID
    WHERE T.VISIT_id IS NULL
    GROUP BY V.Customer_ID
    
  - Find the Team Size
    Write an SQL query to find the team size of each of the employees.
    
    SELECT employee_id,
        COUNT(team_id) OVER(PARTITION BY team_id) AS team_size 
      FROM Employee
      GROUP BY employee_id;
      
      
      ((OR))
     
     SELECT a.employee_id,
        t.team_size
      FROM Employee a
      LEFT JOIN (SELECT team_id, count(*) as team_size
                  FROM Employee
                  GROUP BY team_id
                  )t
      ON a.team_id = t.team_id; 
